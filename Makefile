more robust error handling
catch non-null terminated lines
